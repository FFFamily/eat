<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>订单结算单</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'SimSun', 'Microsoft YaHei', 'PingFang SC', serif;
            font-size: 12px;
            line-height: 1.5;
            color: #333;
            background: white;
            padding: 40px;
        }
        
        .settlement-preview {
            background: white;
            min-height: 100%;
        }
        
        /* 结算单标题 */
        .settlement-title {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .settlement-title h1 {
            font-size: 28px;
            font-weight: bold;
            margin: 0;
        }
        
        /* 合同基本信息 */
        .contract-info {
            margin-bottom: 30px;
        }
        
        .contract-parties {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .party-item {
            display: flex;
            align-items: center;
        }
        
        .party-item .label {
            font-weight: bold;
            min-width: 80px;
        }
        
        .party-item .value {
            margin-left: 10px;
        }
        
        /* 结算说明 */
        .settlement-description {
            text-align: center;
            margin-bottom: 30px;
            font-size: 14px;
        }
        
        .settlement-description p {
            margin: 0;
        }
        
        /* 订单详细信息 */
        .order-details-info {
            margin-bottom: 30px;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .info-item {
            display: flex;
            align-items: center;
        }
        
        .info-item .label {
            font-weight: bold;
            min-width: 180px;
        }
        
        .info-item .value {
            margin-left: 10px;
        }
        
        /* 章节标题 */
        .section-title {
            font-size: 18px;
            font-weight: bold;
            margin: 25px 0 15px 0;
            padding: 8px 0;
            border-bottom: 1px solid #ccc;
        }
        
        /* 订单明细表格 */
        .order-details-table {
            margin-bottom: 20px;
        }
        
        .order-details-table table {
            width: 100%;
            border-collapse: collapse;
            border: 1px solid #ccc;
        }
        
        .order-details-table th,
        .order-details-table td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: center;
        }
        
        .order-details-table th {
            background-color: #f5f5f5;
            font-weight: bold;
        }
        
        .order-details-table .total-row {
            background-color: #f9f9f9;
            font-weight: bold;
        }
        
        .order-details-table .total-label {
            text-align: right;
        }
        
        /* 批注说明 */
        .notes-section {
            margin-top: 5px;
            margin-bottom: 15px;
        }
        
        .notes-text {
            font-size: 10px;
            color: #666;
            margin: 0;
        }
        
        /* 调价部分 */
        .adjustment-section {
            margin-top: 30px;
        }
        
        .adjustment-content {
            margin-bottom: 20px;
        }
        
        .adjustment-summary {
            font-size: 14px;
            margin-bottom: 15px;
            text-align: left;
        }
        
        .adjustment-details {
            margin-left: 20px;
        }
        
        .adjustment-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 10px;
            line-height: 1.6;
        }
        
        .adjustment-number {
            font-weight: bold;
            margin-right: 8px;
            min-width: 30px;
        }
        
        .adjustment-label {
            font-weight: bold;
            margin-right: 8px;
            min-width: 80px;
        }
        
        .adjustment-value {
            flex: 1;
        }
        
        /* 结算金额部分 */
        .settlement-amount-section {
            margin-top: 30px;
        }
        
        .settlement-content {
            margin-bottom: 20px;
        }
        
        .settlement-summary {
            font-size: 14px;
            margin-bottom: 15px;
            line-height: 1.6;
        }
        
        .settlement-amount-words {
            font-size: 14px;
            margin-bottom: 15px;
            line-height: 1.6;
        }
        
        .settlement-account {
            font-size: 14px;
            margin-bottom: 15px;
            line-height: 1.6;
        }
        
        .settlement-request {
            font-size: 14px;
            margin-bottom: 15px;
            line-height: 1.6;
        }
        
        /* 最终批注 */
        .final-notes-section {
            margin-top: 30px;
            margin-bottom: 30px;
        }
        
        .final-notes-text {
            font-size: 12px;
            color: #666;
            line-height: 1.6;
            margin: 0;
        }
        
        /* 公司信息和日期 */
        .company-info-footer {
            margin-top: 50px;
            text-align: right;
        }
        
        .company-name {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .settlement-date {
            font-size: 12px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="settlement-preview">
        <!-- 结算单标题 -->
        <div class="settlement-title">
            <h1>订单结算单</h1>
        </div>

        <!-- 合同基本信息 -->
        <div class="contract-info">
            <div class="contract-parties">
                <div class="party-item">
                    <span class="label">供方：</span>
                    <span class="value" th:text="${orderData.partyAName ?: '--'}">甲方名称</span>
                </div>
                <div class="party-item">
                    <span class="label">需方：</span>
                    <span class="value" th:text="${orderData.partyBName ?: '--'}">乙方名称</span>
                </div>
            </div>
        </div>

        <!-- 结算说明 -->
        <div class="settlement-description">
            <p>按合同 <strong th:text="${orderData.contractNo ?: '--'}">合同编号</strong> 约定, 现就该合同下编号为 <strong th:text="${orderData.no ?: '--'}">订单编号</strong> 的订单进行结算</p>
        </div>


        <!-- 常规部分 -->
        <div class="regular-section">
            <h2 class="section-title">常规部分</h2>

            <!-- （1）订单内容 -->
            <p class="info-item">
                <span class="label">（1）订单内容：</span><br/>
                <span class="value"></span>
            </p>

            <!-- 订单明细表格 -->
            <div class="order-details-table">
                <table>
                    <thead>
                        <tr>
                            <th>序号</th>
                            <th>类型</th>
                            <th>名称</th>
                            <th>规格型号</th>
                            <th>数量</th>
                            <th>单价</th>
                            <th>金额</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="item, iterStat : ${orderItems}">
                            <td th:text="${iterStat.count}">序号</td>
                            <td th:text="${item.typeText}">类型</td>
                            <td th:text="${item.name}">名称</td>
                            <td th:text="${item.specification}">规格型号</td>
                            <td th:text="${item.quantity}">数量</td>
                            <td th:text="${item.unitPrice}">单价</td>
                            <td th:text="${item.amount}">金额</td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <tr class="total-row">
                            <td colspan="4" class="total-label">合计</td>
                            <td th:text="${totalQuantity}">总数量</td>
                            <td th:text="${totalUnitPrice}">总单价</td>
                            <td th:text="${totalAmount}">总金额</td>
                        </tr>
                    </tfoot>
                </table>
            </div>

            <!-- 批注说明 -->
            <div class="notes-section">
                <p class="notes-text">
                    <strong>批注：</strong>货物类数量单位为kg、运输类数量单位为kg，总价单位为元
                </p>
            </div>

            <!-- 常规部分补充信息 -->
            <div class="regular-info-content">
                <p class="info-item">
                    <span class="label">（2）交付地址：</span><br/>
                    <span class="value" th:text="${deliveryAddress ?: '--'}">交付地点字段</span>
                </p>
                <p class="info-item">
                    <span class="label">（3）订单时间：</span><br/>
                    <span class="value">
                        开始时间：<span th:text="${startTime ?: '--'}">起始时间字段</span>；结束时间：<span th:text="${endTime ?: '--'}">结束时间字段</span>
                    </span>
                </p>
                <p class="info-item">
                    <span class="label">（4）订单经办人：</span><br/>
                    <span class="value">
                        供方公司名称：<span th:text="${partyBCompanyName ?: '--'}">供方公司名称</span>；供方经办人：<span th:text="${partyBProcessor ?: '--'}">供方经办人字段</span>（<span th:text="${partyBProcessorPhone ?: '--'}">供方经办人电话字段</span>）<br/>
                        需方公司名称：<span th:text="${partyACompanyName ?: '--'}">需方公司名称</span>；需方经办人：<span th:text="${partyAProcessor ?: '--'}">需方经办人字段</span>（<span th:text="${partyAProcessorPhone ?: '--'}">需方经办人电话字段</span>）
                    </span>
                </p>
            </div>
        </div>

        <!-- 调价部分 -->
        <div class="adjustment-section">
            <h2 class="section-title">调价部分</h2>
            <div class="adjustment-content">
                <p class="adjustment-summary">
                    此结算单调价共调价 <strong th:text="${totalAdjustment}">总调价</strong> 元
                </p>
                <div class="adjustment-details">
                    <div class="adjustment-item">
                        <span class="adjustment-number">（1）</span>
                        <span class="adjustment-label">合作评级：</span>
                        <span class="adjustment-value">
                            评级<span th:text="${ratingLevel}">A</span>，总金额调整<span th:text="${ratingCoefficient}">评级调价</span>，调价<span th:text="${ratingAdjustment}">评级调价</span>元
                        </span>
                    </div>
                    <div class="adjustment-item">
                        <span class="adjustment-number">（2）</span>
                        <span class="adjustment-label">其他调价：</span>
                        <span class="adjustment-value">调价<span th:text="${otherAdjustment}">其他调价</span>元</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- 结算金额部分 -->
        <div class="settlement-amount-section">
            <h2 class="section-title">结算金额</h2>
            <div class="settlement-content">
                <p class="settlement-summary">
                    该笔订单总数 <strong th:text="${totalQuantity}">总数</strong> <span>kg</span>，待结金额 <strong th:text="${pendingAmount}">待结金额</strong> 元，综合单价 <strong th:text="${averageUnitPrice}">综合单价</strong> 元/<span>kg</span>
                </p>
                <p class="settlement-amount-words">
                    待结金额大写：<strong th:text="${amountToChinese}">金额大写</strong>
                </p>
                <!-- <p class="settlement-account">
                    约定走款账号：<strong th:text="${orderData.paymentAccount ?: '6222021234567890123'}">走款账号</strong>
                </p> -->
                <p class="settlement-request">
                    请您核算以上数据，我司将据此结算。
                </p>
            </div>
        </div>

        <!-- 四、其他信息 -->
        <div class="other-info-section">
            <h2 class="section-title">四、其他信息</h2>

            <div class="other-info-content">
                <p class="info-item">
                    <span class="label">（1）合规提示：</span>
                    <span class="value">按合同约定，您承诺并确认交付的货物来源合法、安全，非盗窃、抢劫等非法所得。</span>
                </p>

                <p class="info-item">
                    <span class="label">（2）授权提示：</span>
                    <span class="value">按合同约定，您的“同意”行为视为您同意本结算单。</span>
                </p>

                <p class="info-item">
                    <span class="label">（3）异议提示：</span>
                    <span class="value">按合同约定，我们将通过一种或多种方式提醒您经办本结算单，如有疑问请于本单据发出后7个工作日内联系我司企业微信客服，过时默认同意本结算单内容。</span>
                </p>
            </div>
        </div>

        <!-- 最终批注 -->
        <!-- <div class="final-notes-section">
            <p class="final-notes-text">
                如有疑问请于本单据发出后3个工作日内联系我司企业微信客服或经办人员 <strong>孟经理（13683335083）</strong>，过时默认同意本结算单内容。
            </p>
        </div> -->

        <!-- 公司信息和日期 -->
        <div class="company-info-footer">
            <div class="company-name">云南伏宁再生资源有限公司</div>
            <div class="settlement-date">结算单生成日期：<span th:text="${settlementDate}">日期</span></div>
        </div>
    </div>
</body>
</html>

